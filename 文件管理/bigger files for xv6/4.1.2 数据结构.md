#4.1.2 数据结构

##个性化推荐算法

###数据应用

对于个性化推荐模块，我们需要根据丰富的用户行为数据来反映不同的用户意图。

| 行为类别     | 行为详情                                         |
| ------------ | ------------------------------------------------ |
| 主动行为数据 | 搜索、筛选、点击、收藏、评分                     |
| UGC          | 文本评价、上传图片                               |
| 负反馈数据   | 取消收藏、负面评价、低分评分                     |
| 用户画像     | 用户人口属性、品类偏好、消费水平、工作地与居住地 |

1. 用户主动行为数据记录了用户在平台上不同的环节的各种行为，这些行为一方面用于候选集触发算法（在下一部分介绍）中的离线计算（主要是浏览、收藏），另外一方面，这些行为代表的意图的强弱不同，因此在训练重排序模型时可以针对不同的行为设定不同的回归目标值，以更细地刻画用户的行为强弱程度。此外，用户对deal的这些行为还可以作为重排序模型的交叉特征，用于模型的离线训练和在线预测。
2. 负反馈数据反映了当前的结果可能在某些方面不能满足用户的需求，因此在后续的候选集触发过程中需要考虑对特定的因素进行过滤或者降权，降低负面因素再次出现的几率，提高用户体验；同时在重排序的模型训练中，负反馈数据可以作为不可多得的负例参与模型训练，这些负例要比那些展示后未点击、未下单的样本显著的多。
3. 用户画像是刻画用户属性的基础数据，其中有些是直接获取的原始数据，有些是经过挖掘的二次加工数据，这些属性一方面可以用于候选集触发过程中对deal进行加权或降权，另外一方面可以作为重排序模型中的用户维度特征。
4. 通过对UGC数据的挖掘可以提取出一些关键词，然后使用这些关键词给deal打标签，用于deal的个性化展示。

### 策略触发

对于上一段提到的数据，它们的落脚点还是算法和模型。单纯的数据只是一些字节的堆积，我们必须通过对数据的清洗去除数据中的噪声，然后通过算法和模型学习其中的规律，才能将数据的价值最大化。在系统中，推荐候选集触发过程中用到的相关算法有以下几种。

1. **协同过滤**

   协同过滤基本的算法非常简单，但是要获得更好的效果，往往需要根据具体的业务做一些差异化的处理：

   - 清除作弊、刷好评、代购等噪声数据。这些数据的存在会严重影响算法的效果，因此要在第一步的数据清洗中就将这些数据剔除。
   - 合理选取训练数据。选取的训练数据的时间窗口不宜过长，当然也不能过短。具体的窗口期数值需要经过多次的实验来确定。同时可以考虑引入时间衰减，因为近期的用户行为更能反映用户接下来的行为动作。
   - user-based与item-based相结合。

|            | 群体/个体                                  | 计算代价               | 适用场景                               | 冷启动                         | 可解释性 | 实时性                               |
| ---------- | ------------------------------------------ | ---------------------- | -------------------------------------- | ------------------------------ | -------- | ------------------------------------ |
| User-based | 更依赖于当前用户相近的用户群体的社会化行为 | 适用于用户数较少的场合 | 时效性强，用户个性化兴趣不太显著的场合 | 新加入的物品能很快进入推荐列表 | 弱       | 用户新的行为不一定导致推荐结果的变化 |
| Item-based | 更侧重于用户自身的个体行为                 | 适用于物品数较少的场合 | 物品丰富，用户个性化需求强烈的场合     | 新加入的用户能很快得到推荐     | 强       | 用户新的行为一定导致推荐结果的变化   |

